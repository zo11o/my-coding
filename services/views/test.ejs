<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
</head>
<body>
    是打发斯蒂芬<%= title %>
</body>
</html>

<script>

    // 1. 同步
    // var xhr = new XMLHttpRequest();
    // xhr.open('get', '/api/getId?id=5342546', false);
    // xhr.send(null)

    // if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {
    //     console.log(xhr.status , xhr.responseText);
    // } else {
    //     alert("Request was unsuccessfun:" + xhr.status)
    // }

    // 2. 异步
    var xhr = new XMLHttpRequest();
    // readyState 有五个状态。 每次状态变更会触发 onreadyStatechange 事件
    // 0 尚未open
    // 1 已经open 尚未 send
    // 2 已经 send
    // 3 接收部分
    // 4 全部接收完成

    var getUrl = addURLParam('/api/getId', 'id' , 'asdfli345')

    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4) {
            if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304) {
                // console.log(xhr.responseText);

                // 获取全部响应头的方法 xhr.getAllResponseHeaders();
                var responseHeader = xhr.getAllResponseHeaders();
                console.log(responseHeader);

                var data = xhr.responseText
                data = JSON.parse(data);
                console.log(data);
            } else {
                console.log('fail:' + xhr.status)
            }
        }
    }
    xhr.open('get', getUrl, true);
    xhr.setRequestHeader('MyHeader', "myValue")
    xhr.send(null)

    function addURLParam(url, name, value) {
        url += url.indexOf('?') == -1 ? '?' : '&';
        url += encodeURIComponent(name) + '=' + encodeURIComponent(value)
        return url
    }
</script>